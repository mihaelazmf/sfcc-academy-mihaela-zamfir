{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./cartridges/app_storefront_base/cartridge/client/default/js/cart.js","webpack:///./cartridges/app_storefront_base/cartridge/client/default/js/cart/cart.js","webpack:///./cartridges/app_storefront_base/cartridge/client/default/js/components/focus.js","webpack:///./cartridges/app_storefront_base/cartridge/client/default/js/product/base.js","webpack:///./cartridges/app_storefront_base/cartridge/client/default/js/util.js"],"names":["processInclude","require","$","document","ready","base","focusHelper","appendToUrl","url","params","newUrl","indexOf","Object","keys","map","key","encodeURIComponent","join","validateBasket","data","valid","error","message","errorHtml","append","empty","resources","emptyCartMsg","numberOfItems","numItems","attr","minicartCountOfItems","title","removeClass","addClass","updateCartTotals","totals","totalShippingCost","totalTax","grandTotal","subTotal","orderLevelDiscountTotal","value","formatted","shippingLevelDiscountTotal","items","forEach","item","renderedPromotions","UUID","priceTotal","renderedPrice","createErrorNotification","updateApproachingDiscounts","approachingDiscounts","html","length","discountMsg","updateAvailability","uuid","lineItem","messages","i","availability","inStockDate","findItem","array","match","l","call","updateProductDetails","cartModel","variationAttributes","colorAttr","attributeId","colorSelector","newColor","displayValue","text","sizeAttr","sizeSelector","newSize","imageSelector","images","small","alt","options","option","optSelector","optionId","selectedValueId","displayName","qtySelector","val","quantity","newProductId","priceSelector","price","sales","decimalPrice","list","listPriceSelector","getModalHtmlElement","remove","htmlString","parseHtml","$html","parseHTML","body","find","footer","children","fillModalElement","editProductUrl","spinner","start","ajax","method","dataType","success","parsedHtml","renderedTemplate","closeButtonText","enterDialogMessage","modal","stop","confirmDelete","actionUrl","productID","productName","$deleteConfirmBtn","$productToRemoveSpan","module","exports","on","e","preventDefault","click","toggle","urlParams","pid","type","basket","toBeDeletedUUIDs","hasBonusProduct","discountsHtml","trigger","err","responseJSON","redirectUrl","window","location","href","errorMessage","preSelectQty","parents","context","hasClass","reload","parseInt","change","methodID","submit","hide","show","$form","serialize","couponCode","code","methods","editBonusProducts","focus","siblings","focusParams","event","containerSelector","firstElementSelector","lastElementSelector","nextToLastElementSelector","setTabNextFocus","response","dialog","$productContainer","closest","product","readyToOrder","available","allAvailable","toArray","every","allReady","info_selectforstock","container","id","selectedQuantity","selectedOptionValueId","updateProductUrl","form","getPidValue","uuidToBeDeleted","selectAttribute","colorAttribute","removeBonusProduct","selectBonusProduct","enableBonusProductSelection","showMoreBonusProducts","addBonusProductsToCart","focusChooseBonusProductModal","trapChooseBonusProductModalFocus","onClosingChooseBonusProductModal","KEYCODE_TAB","isTabPressed","keyCode","firstFocusableEl","lastFocusableEl","is","linkElements","shiftKey","$el","getQuantitySelector","getQuantitySelected","processSwatchValues","msgs","values","attrValue","$attrValue","$swatchButton","parent","selected","assistiveSelectedText","removeAttr","selectable","processNonSwatchValues","$attr","$defaultOption","resetUrl","updateAttrs","attrs","attrsWithSwatches","availabilityValue","availabilityMessages","getAttributesHtml","attributes","attributeGroup","ID","attribute","label","updateOptions","optionsHtml","createCarousel","imgs","carousel","carouselId","index","appendTo","first","detach","handleVariantResponse","isChoiceOfBonusProducts","isVaraint","productType","primaryImageUrls","large","$priceSelector","replaceWith","promotionsHtml","$selectButton","updateQuantities","quantities","attributeSelect","selectedValueUrl","getAddToCartUrl","chooseBonusProducts","bonusUrl","bonusChoiceRuleBased","showProductsUrlRuleBased","showProductsUrlListBased","maxBonusItems","pliUUID","addToCartUrl","pageSize","labels","selectprods","handlePostCartAdd","messageType","newBonusDiscountLineItem","setTimeout","getChildProducts","childProducts","each","push","JSON","stringify","getOptions","$elOption","urlValue","miniCartReportingUrl","currentTarget","addToCart","pidsObj","setPids","qty","reportingURL","$choiceOfBonusProduct","maxPids","submittedQty","totalQty","optionID","valueId","selectedBonusProductHtml","$selected","count","$readyToOrderBonusProducts","queryString","pidsObject","bonusProducts","qtyOption","productId","msgSuccess","include"],"mappings":"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","file":"default/js/cart.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./cartridges/app_storefront_base/cartridge/client/default/js/cart.js\");\n","'use strict';\n\nvar processInclude = require('./util');\n\n$(document).ready(function () {\n    processInclude(require('./cart/cart'));\n});\n","'use strict';\n\nvar base = require('../product/base');\nvar focusHelper = require('../components/focus');\n\n/**\n * appends params to a url\n * @param {string} url - Original url\n * @param {Object} params - Parameters to append\n * @returns {string} result url with appended parameters\n */\nfunction appendToUrl(url, params) {\n    var newUrl = url;\n    newUrl += (newUrl.indexOf('?') !== -1 ? '&' : '?') + Object.keys(params).map(function (key) {\n        return key + '=' + encodeURIComponent(params[key]);\n    }).join('&');\n\n    return newUrl;\n}\n\n/**\n * Checks whether the basket is valid. if invalid displays error message and disables\n * checkout button\n * @param {Object} data - AJAX response from the server\n */\nfunction validateBasket(data) {\n    if (data.valid.error) {\n        if (data.valid.message) {\n            var errorHtml = '<div class=\"alert alert-danger alert-dismissible valid-cart-error ' +\n                'fade show\" role=\"alert\">' +\n                '<button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\">' +\n                '<span aria-hidden=\"true\">&times;</span>' +\n                '</button>' + data.valid.message + '</div>';\n\n            $('.cart-error').append(errorHtml);\n        } else {\n            $('.cart').empty().append('<div class=\"row\"> ' +\n                '<div class=\"col-12 text-center\"> ' +\n                '<h1>' + data.resources.emptyCartMsg + '</h1> ' +\n                '</div> ' +\n                '</div>'\n            );\n            $('.number-of-items').empty().append(data.resources.numberOfItems);\n            $('.minicart-quantity').empty().append(data.numItems);\n            $('.minicart-link').attr({\n                'aria-label': data.resources.minicartCountOfItems,\n                title: data.resources.minicartCountOfItems\n            });\n            $('.minicart .popover').empty();\n            $('.minicart .popover').removeClass('show');\n        }\n\n        $('.checkout-btn').addClass('disabled');\n    } else {\n        $('.checkout-btn').removeClass('disabled');\n    }\n}\n\n/**\n * re-renders the order totals and the number of items in the cart\n * @param {Object} data - AJAX response from the server\n */\nfunction updateCartTotals(data) {\n    $('.number-of-items').empty().append(data.resources.numberOfItems);\n    $('.shipping-cost').empty().append(data.totals.totalShippingCost);\n    $('.tax-total').empty().append(data.totals.totalTax);\n    $('.grand-total').empty().append(data.totals.grandTotal);\n    $('.sub-total').empty().append(data.totals.subTotal);\n    $('.minicart-quantity').empty().append(data.numItems);\n    $('.minicart-link').attr({\n        'aria-label': data.resources.minicartCountOfItems,\n        title: data.resources.minicartCountOfItems\n    });\n    if (data.totals.orderLevelDiscountTotal.value > 0) {\n        $('.order-discount').removeClass('hide-order-discount');\n        $('.order-discount-total').empty()\n            .append('- ' + data.totals.orderLevelDiscountTotal.formatted);\n    } else {\n        $('.order-discount').addClass('hide-order-discount');\n    }\n\n    if (data.totals.shippingLevelDiscountTotal.value > 0) {\n        $('.shipping-discount').removeClass('hide-shipping-discount');\n        $('.shipping-discount-total').empty().append('- ' +\n            data.totals.shippingLevelDiscountTotal.formatted);\n    } else {\n        $('.shipping-discount').addClass('hide-shipping-discount');\n    }\n\n    data.items.forEach(function (item) {\n        if (item.renderedPromotions) {\n            $('.item-' + item.UUID).empty().append(item.renderedPromotions);\n        }\n        if (item.priceTotal && item.priceTotal.renderedPrice) {\n            $('.item-total-' + item.UUID).empty().append(item.priceTotal.renderedPrice);\n        }\n    });\n}\n\n/**\n * re-renders the order totals and the number of items in the cart\n * @param {Object} message - Error message to display\n */\nfunction createErrorNotification(message) {\n    var errorHtml = '<div class=\"alert alert-danger alert-dismissible valid-cart-error ' +\n        'fade show\" role=\"alert\">' +\n        '<button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\">' +\n        '<span aria-hidden=\"true\">&times;</span>' +\n        '</button>' + message + '</div>';\n\n    $('.cart-error').append(errorHtml);\n}\n\n/**\n * re-renders the approaching discount messages\n * @param {Object} approachingDiscounts - updated approaching discounts for the cart\n */\nfunction updateApproachingDiscounts(approachingDiscounts) {\n    var html = '';\n    $('.approaching-discounts').empty();\n    if (approachingDiscounts.length > 0) {\n        approachingDiscounts.forEach(function (item) {\n            html += '<div class=\"single-approaching-discount text-center\">'\n                + item.discountMsg + '</div>';\n        });\n    }\n    $('.approaching-discounts').append(html);\n}\n\n/**\n * Updates the availability of a product line item\n * @param {Object} data - AJAX response from the server\n * @param {string} uuid - The uuid of the product line item to update\n */\nfunction updateAvailability(data, uuid) {\n    var lineItem;\n    var messages = '';\n\n    for (var i = 0; i < data.items.length; i++) {\n        if (data.items[i].UUID === uuid) {\n            lineItem = data.items[i];\n            break;\n        }\n    }\n\n    $('.availability-' + lineItem.UUID).empty();\n\n    if (lineItem.availability) {\n        if (lineItem.availability.messages) {\n            lineItem.availability.messages.forEach(function (message) {\n                messages += '<p class=\"line-item-attributes\">' + message + '</p>';\n            });\n        }\n\n        if (lineItem.availability.inStockDate) {\n            messages += '<p class=\"line-item-attributes line-item-instock-date\">'\n                + lineItem.availability.inStockDate\n                + '</p>';\n        }\n    }\n\n    $('.availability-' + lineItem.UUID).html(messages);\n}\n\n/**\n * Finds an element in the array that matches search parameter\n * @param {array} array - array of items to search\n * @param {function} match - function that takes an element and returns a boolean indicating if the match is made\n * @returns {Object|null} - returns an element of the array that matched the query.\n */\nfunction findItem(array, match) {\n    for (var i = 0, l = array.length; i < l; i++) {\n        if (match.call(this, array[i])) {\n            return array[i];\n        }\n    }\n    return null;\n}\n\n/**\n * Updates details of a product line item\n * @param {Object} data - AJAX response from the server\n * @param {string} uuid - The uuid of the product line item to update\n */\nfunction updateProductDetails(data, uuid) {\n    var lineItem = findItem(data.cartModel.items, function (item) {\n        return item.UUID === uuid;\n    });\n\n    if (lineItem.variationAttributes) {\n        var colorAttr = findItem(lineItem.variationAttributes, function (attr) {\n            return attr.attributeId === 'color';\n        });\n\n        if (colorAttr) {\n            var colorSelector = '.Color-' + uuid;\n            var newColor = 'Color: ' + colorAttr.displayValue;\n            $(colorSelector).text(newColor);\n        }\n\n        var sizeAttr = findItem(lineItem.variationAttributes, function (attr) {\n            return attr.attributeId === 'size';\n        });\n\n        if (sizeAttr) {\n            var sizeSelector = '.Size-' + uuid;\n            var newSize = 'Size: ' + sizeAttr.displayValue;\n            $(sizeSelector).text(newSize);\n        }\n\n        var imageSelector = '.card.product-info.uuid-' + uuid + ' .item-image > img';\n        $(imageSelector).attr('src', lineItem.images.small[0].url);\n        $(imageSelector).attr('alt', lineItem.images.small[0].alt);\n        $(imageSelector).attr('title', lineItem.images.small[0].title);\n    }\n\n    if (lineItem.options && lineItem.options.length) {\n        var option = lineItem.options[0];\n        var optSelector = '.lineItem-options-values[data-option-id=\"' + option.optionId + '\"]';\n        $(optSelector).data('value-id', option.selectedValueId);\n        $(optSelector + ' .line-item-attributes').text(option.displayName);\n    }\n\n    var qtySelector = '.quantity[data-uuid=\"' + uuid + '\"]';\n    $(qtySelector).val(lineItem.quantity);\n    $(qtySelector).data('pid', data.newProductId);\n\n    $('.remove-product[data-uuid=\"' + uuid + '\"]').data('pid', data.newProductId);\n\n    var priceSelector = '.line-item-price-' + uuid + ' .sales .value';\n    $(priceSelector).text(lineItem.price.sales.formatted);\n    $(priceSelector).attr('content', lineItem.price.sales.decimalPrice);\n\n    if (lineItem.price.list) {\n        var listPriceSelector = '.line-item-price-' + uuid + ' .list .value';\n        $(listPriceSelector).text(lineItem.price.list.formatted);\n        $(listPriceSelector).attr('content', lineItem.price.list.decimalPrice);\n    }\n}\n\n/**\n * Generates the modal window on the first call.\n *\n */\nfunction getModalHtmlElement() {\n    if ($('#editProductModal').length !== 0) {\n        $('#editProductModal').remove();\n    }\n    var htmlString = '<!-- Modal -->'\n        + '<div class=\"modal fade\" id=\"editProductModal\" tabindex=\"-1\" role=\"dialog\">'\n        + '<span class=\"enter-message sr-only\" ></span>'\n        + '<div class=\"modal-dialog quick-view-dialog\">'\n        + '<!-- Modal content-->'\n        + '<div class=\"modal-content\">'\n        + '<div class=\"modal-header\">'\n        + '    <button type=\"button\" class=\"close pull-right\" data-dismiss=\"modal\">'\n        + '        <span aria-hidden=\"true\">&times;</span>'\n        + '        <span class=\"sr-only\"> </span>'\n        + '    </button>'\n        + '</div>'\n        + '<div class=\"modal-body\"></div>'\n        + '<div class=\"modal-footer\"></div>'\n        + '</div>'\n        + '</div>'\n        + '</div>';\n    $('body').append(htmlString);\n}\n\n/**\n * Parses the html for a modal window\n * @param {string} html - representing the body and footer of the modal window\n *\n * @return {Object} - Object with properties body and footer.\n */\nfunction parseHtml(html) {\n    var $html = $('<div>').append($.parseHTML(html));\n\n    var body = $html.find('.product-quickview');\n    var footer = $html.find('.modal-footer').children();\n\n    return { body: body, footer: footer };\n}\n\n/**\n * replaces the content in the modal window for product variation to be edited.\n * @param {string} editProductUrl - url to be used to retrieve a new product model\n */\nfunction fillModalElement(editProductUrl) {\n    $('.modal-body').spinner().start();\n    $.ajax({\n        url: editProductUrl,\n        method: 'GET',\n        dataType: 'json',\n        success: function (data) {\n            var parsedHtml = parseHtml(data.renderedTemplate);\n\n            $('#editProductModal .modal-body').empty();\n            $('#editProductModal .modal-body').html(parsedHtml.body);\n            $('#editProductModal .modal-footer').html(parsedHtml.footer);\n            $('#editProductModal .modal-header .close .sr-only').text(data.closeButtonText);\n            $('#editProductModal .enter-message').text(data.enterDialogMessage);\n            $('#editProductModal').modal('show');\n            $.spinner().stop();\n        },\n        error: function () {\n            $.spinner().stop();\n        }\n    });\n}\n\n/**\n * replace content of modal\n * @param {string} actionUrl - url to be used to remove product\n * @param {string} productID - pid\n * @param {string} productName - product name\n * @param {string} uuid - uuid\n */\nfunction confirmDelete(actionUrl, productID, productName, uuid) {\n    var $deleteConfirmBtn = $('.cart-delete-confirmation-btn');\n    var $productToRemoveSpan = $('.product-to-remove');\n\n    $deleteConfirmBtn.data('pid', productID);\n    $deleteConfirmBtn.data('action', actionUrl);\n    $deleteConfirmBtn.data('uuid', uuid);\n\n    $productToRemoveSpan.empty().append(productName);\n}\n\nmodule.exports = function () {\n    $('body').on('click', '.remove-product', function (e) {\n        e.preventDefault();\n\n        var actionUrl = $(this).data('action');\n        var productID = $(this).data('pid');\n        var productName = $(this).data('name');\n        var uuid = $(this).data('uuid');\n        confirmDelete(actionUrl, productID, productName, uuid);\n    });\n\n    $('body').on('afterRemoveFromCart', function (e, data) {\n        e.preventDefault();\n        confirmDelete(data.actionUrl, data.productID, data.productName, data.uuid);\n    });\n\n    $('.optional-promo').click(function (e) {\n        e.preventDefault();\n        $('.promo-code-form').toggle();\n    });\n\n    $('body').on('click', '.cart-delete-confirmation-btn', function (e) {\n        e.preventDefault();\n\n        var productID = $(this).data('pid');\n        var url = $(this).data('action');\n        var uuid = $(this).data('uuid');\n        var urlParams = {\n            pid: productID,\n            uuid: uuid\n        };\n\n        url = appendToUrl(url, urlParams);\n\n        $('body > .modal-backdrop').remove();\n\n        $.spinner().start();\n        $.ajax({\n            url: url,\n            type: 'get',\n            dataType: 'json',\n            success: function (data) {\n                if (data.basket.items.length === 0) {\n                    $('.cart').empty().append('<div class=\"row\"> ' +\n                        '<div class=\"col-12 text-center\"> ' +\n                        '<h1>' + data.basket.resources.emptyCartMsg + '</h1> ' +\n                        '</div> ' +\n                        '</div>'\n                    );\n                    $('.number-of-items').empty().append(data.basket.resources.numberOfItems);\n                    $('.minicart-quantity').empty().append(data.basket.numItems);\n                    $('.minicart-link').attr({\n                        'aria-label': data.basket.resources.minicartCountOfItems,\n                        title: data.basket.resources.minicartCountOfItems\n                    });\n                    $('.minicart .popover').empty();\n                    $('.minicart .popover').removeClass('show');\n                    $('body').removeClass('modal-open');\n                    $('html').removeClass('veiled');\n                } else {\n                    if (data.toBeDeletedUUIDs && data.toBeDeletedUUIDs.length > 0) {\n                        for (var i = 0; i < data.toBeDeletedUUIDs.length; i++) {\n                            $('.uuid-' + data.toBeDeletedUUIDs[i]).remove();\n                        }\n                    }\n                    $('.uuid-' + uuid).remove();\n                    if (!data.basket.hasBonusProduct) {\n                        $('.bonus-product').remove();\n                    }\n                    $('.coupons-and-promos').empty().append(data.basket.totals.discountsHtml);\n                    updateCartTotals(data.basket);\n                    updateApproachingDiscounts(data.basket.approachingDiscounts);\n                    $('body').trigger('setShippingMethodSelection', data.basket);\n                    validateBasket(data.basket);\n                }\n\n                $('body').trigger('cart:update');\n\n                $.spinner().stop();\n            },\n            error: function (err) {\n                if (err.responseJSON.redirectUrl) {\n                    window.location.href = err.responseJSON.redirectUrl;\n                } else {\n                    createErrorNotification(err.responseJSON.errorMessage);\n                    $.spinner().stop();\n                }\n            }\n        });\n    });\n\n    $('body').on('change', '.quantity-form > .quantity', function () {\n        var preSelectQty = $(this).data('pre-select-qty');\n        var quantity = $(this).val();\n        var productID = $(this).data('pid');\n        var url = $(this).data('action');\n        var uuid = $(this).data('uuid');\n\n        var urlParams = {\n            pid: productID,\n            quantity: quantity,\n            uuid: uuid\n        };\n        url = appendToUrl(url, urlParams);\n\n        $(this).parents('.card').spinner().start();\n\n        $.ajax({\n            url: url,\n            type: 'get',\n            context: this,\n            dataType: 'json',\n            success: function (data) {\n                $('.quantity[data-uuid=\"' + uuid + '\"]').val(quantity);\n                $('.coupons-and-promos').empty().append(data.totals.discountsHtml);\n                updateCartTotals(data);\n                updateApproachingDiscounts(data.approachingDiscounts);\n                updateAvailability(data, uuid);\n                validateBasket(data);\n                $(this).data('pre-select-qty', quantity);\n\n                $('body').trigger('cart:update');\n\n                $.spinner().stop();\n                if ($(this).parents('.product-info').hasClass('bonus-product-line-item') && $('.cart-page').length) {\n                    location.reload();\n                }\n            },\n            error: function (err) {\n                if (err.responseJSON.redirectUrl) {\n                    window.location.href = err.responseJSON.redirectUrl;\n                } else {\n                    createErrorNotification(err.responseJSON.errorMessage);\n                    $(this).val(parseInt(preSelectQty, 10));\n                    $.spinner().stop();\n                }\n            }\n        });\n    });\n\n    $('.shippingMethods').change(function () {\n        var url = $(this).attr('data-actionUrl');\n        var urlParams = {\n            methodID: $(this).find(':selected').attr('data-shipping-id')\n        };\n        // url = appendToUrl(url, urlParams);\n\n        $('.totals').spinner().start();\n        $.ajax({\n            url: url,\n            type: 'post',\n            dataType: 'json',\n            data: urlParams,\n            success: function (data) {\n                if (data.error) {\n                    window.location.href = data.redirectUrl;\n                } else {\n                    $('.coupons-and-promos').empty().append(data.totals.discountsHtml);\n                    updateCartTotals(data);\n                    updateApproachingDiscounts(data.approachingDiscounts);\n                    validateBasket(data);\n                }\n                $.spinner().stop();\n            },\n            error: function (err) {\n                if (err.redirectUrl) {\n                    window.location.href = err.redirectUrl;\n                } else {\n                    createErrorNotification(err.responseJSON.errorMessage);\n                    $.spinner().stop();\n                }\n            }\n        });\n    });\n\n    $('.promo-code-form').submit(function (e) {\n        e.preventDefault();\n        $.spinner().start();\n        $('.coupon-missing-error').hide();\n        $('.coupon-error-message').empty();\n        if (!$('.coupon-code-field').val()) {\n            $('.promo-code-form .form-control').addClass('is-invalid');\n            $('.promo-code-form .form-control').attr('aria-describedby', 'missingCouponCode');\n            $('.coupon-missing-error').show();\n            $.spinner().stop();\n            return false;\n        }\n        var $form = $('.promo-code-form');\n        $('.promo-code-form .form-control').removeClass('is-invalid');\n        $('.coupon-error-message').empty();\n\n        $.ajax({\n            url: $form.attr('action'),\n            type: 'GET',\n            dataType: 'json',\n            data: $form.serialize(),\n            success: function (data) {\n                if (data.error) {\n                    $('.promo-code-form .form-control').addClass('is-invalid');\n                    $('.promo-code-form .form-control').attr('aria-describedby', 'invalidCouponCode');\n                    $('.coupon-error-message').empty().append(data.errorMessage);\n                } else {\n                    $('.coupons-and-promos').empty().append(data.totals.discountsHtml);\n                    updateCartTotals(data);\n                    updateApproachingDiscounts(data.approachingDiscounts);\n                    validateBasket(data);\n                }\n                $('.coupon-code-field').val('');\n                $.spinner().stop();\n            },\n            error: function (err) {\n                if (err.responseJSON.redirectUrl) {\n                    window.location.href = err.responseJSON.redirectUrl;\n                } else {\n                    createErrorNotification(err.errorMessage);\n                    $.spinner().stop();\n                }\n            }\n        });\n        return false;\n    });\n\n    $('body').on('click', '.remove-coupon', function (e) {\n        e.preventDefault();\n\n        var couponCode = $(this).data('code');\n        var uuid = $(this).data('uuid');\n        var $deleteConfirmBtn = $('.delete-coupon-confirmation-btn');\n        var $productToRemoveSpan = $('.coupon-to-remove');\n\n        $deleteConfirmBtn.data('uuid', uuid);\n        $deleteConfirmBtn.data('code', couponCode);\n\n        $productToRemoveSpan.empty().append(couponCode);\n    });\n\n    $('body').on('click', '.delete-coupon-confirmation-btn', function (e) {\n        e.preventDefault();\n\n        var url = $(this).data('action');\n        var uuid = $(this).data('uuid');\n        var couponCode = $(this).data('code');\n        var urlParams = {\n            code: couponCode,\n            uuid: uuid\n        };\n\n        url = appendToUrl(url, urlParams);\n\n        $('body > .modal-backdrop').remove();\n\n        $.spinner().start();\n        $.ajax({\n            url: url,\n            type: 'get',\n            dataType: 'json',\n            success: function (data) {\n                $('.coupon-uuid-' + uuid).remove();\n                updateCartTotals(data);\n                updateApproachingDiscounts(data.approachingDiscounts);\n                validateBasket(data);\n                $.spinner().stop();\n            },\n            error: function (err) {\n                if (err.responseJSON.redirectUrl) {\n                    window.location.href = err.responseJSON.redirectUrl;\n                } else {\n                    createErrorNotification(err.responseJSON.errorMessage);\n                    $.spinner().stop();\n                }\n            }\n        });\n    });\n    $('body').on('click', '.cart-page .bonus-product-button', function () {\n        $.spinner().start();\n        $(this).addClass('launched-modal');\n        $.ajax({\n            url: $(this).data('url'),\n            method: 'GET',\n            dataType: 'json',\n            success: function (data) {\n                base.methods.editBonusProducts(data);\n                $.spinner().stop();\n            },\n            error: function () {\n                $.spinner().stop();\n            }\n        });\n    });\n\n    $('body').on('hidden.bs.modal', '#chooseBonusProductModal', function () {\n        $('#chooseBonusProductModal').remove();\n        $('.modal-backdrop').remove();\n        $('body').removeClass('modal-open');\n\n        if ($('.cart-page').length) {\n            $('.launched-modal .btn-outline-primary').trigger('focus');\n            $('.launched-modal').removeClass('launched-modal');\n        } else {\n            $('.product-detail .add-to-cart').focus();\n        }\n    });\n\n    $('body').on('click', '.cart-page .product-edit .edit, .cart-page .bundle-edit .edit', function (e) {\n        e.preventDefault();\n\n        var editProductUrl = $(this).attr('href');\n        getModalHtmlElement();\n        fillModalElement(editProductUrl);\n    });\n\n    $('body').on('shown.bs.modal', '#editProductModal', function () {\n        $('#editProductModal').siblings().attr('aria-hidden', 'true');\n        $('#editProductModal .close').focus();\n    });\n\n    $('body').on('hidden.bs.modal', '#editProductModal', function () {\n        $('#editProductModal').siblings().attr('aria-hidden', 'false');\n    });\n\n    $('body').on('keydown', '#editProductModal', function (e) {\n        var focusParams = {\n            event: e,\n            containerSelector: '#editProductModal',\n            firstElementSelector: '.close',\n            lastElementSelector: '.update-cart-product-global',\n            nextToLastElementSelector: '.modal-footer .quantity-select'\n        };\n        focusHelper.setTabNextFocus(focusParams);\n    });\n\n    $('body').on('product:updateAddToCart', function (e, response) {\n        // update global add to cart (single products, bundles)\n        var dialog = $(response.$productContainer)\n            .closest('.quick-view-dialog');\n\n        $('.update-cart-product-global', dialog).attr('disabled',\n            !$('.global-availability', dialog).data('ready-to-order')\n            || !$('.global-availability', dialog).data('available')\n        );\n    });\n\n    $('body').on('product:updateAvailability', function (e, response) {\n        // bundle individual products\n        $('.product-availability', response.$productContainer)\n            .data('ready-to-order', response.product.readyToOrder)\n            .data('available', response.product.available)\n            .find('.availability-msg')\n            .empty()\n            .html(response.message);\n\n\n        var dialog = $(response.$productContainer)\n            .closest('.quick-view-dialog');\n\n        if ($('.product-availability', dialog).length) {\n            // bundle all products\n            var allAvailable = $('.product-availability', dialog).toArray()\n                .every(function (item) { return $(item).data('available'); });\n\n            var allReady = $('.product-availability', dialog).toArray()\n                .every(function (item) { return $(item).data('ready-to-order'); });\n\n            $('.global-availability', dialog)\n                .data('ready-to-order', allReady)\n                .data('available', allAvailable);\n\n            $('.global-availability .availability-msg', dialog).empty()\n                .html(allReady ? response.message : response.resources.info_selectforstock);\n        } else {\n            // single product\n            $('.global-availability', dialog)\n                .data('ready-to-order', response.product.readyToOrder)\n                .data('available', response.product.available)\n                .find('.availability-msg')\n                .empty()\n                .html(response.message);\n        }\n    });\n\n    $('body').on('product:afterAttributeSelect', function (e, response) {\n        if ($('.modal.show .product-quickview .bundle-items').length) {\n            $('.modal.show').find(response.container).data('pid', response.data.product.id);\n            $('.modal.show').find(response.container).find('.product-id').text(response.data.product.id);\n        } else {\n            $('.modal.show .product-quickview').data('pid', response.data.product.id);\n        }\n    });\n\n    $('body').on('change', '.quantity-select', function () {\n        var selectedQuantity = $(this).val();\n        $('.modal.show .update-cart-url').data('selected-quantity', selectedQuantity);\n    });\n\n    $('body').on('change', '.options-select', function () {\n        var selectedOptionValueId = $(this).children('option:selected').data('value-id');\n        $('.modal.show .update-cart-url').data('selected-option', selectedOptionValueId);\n    });\n\n    $('body').on('click', '.update-cart-product-global', function (e) {\n        e.preventDefault();\n\n        var updateProductUrl = $(this).closest('.cart-and-ipay').find('.update-cart-url').val();\n        var selectedQuantity = $(this).closest('.cart-and-ipay').find('.update-cart-url').data('selected-quantity');\n        var selectedOptionValueId = $(this).closest('.cart-and-ipay').find('.update-cart-url').data('selected-option');\n        var uuid = $(this).closest('.cart-and-ipay').find('.update-cart-url').data('uuid');\n\n        var form = {\n            uuid: uuid,\n            pid: base.getPidValue($(this)),\n            quantity: selectedQuantity,\n            selectedOptionValueId: selectedOptionValueId\n        };\n\n        $(this).parents('.card').spinner().start();\n        if (updateProductUrl) {\n            $.ajax({\n                url: updateProductUrl,\n                type: 'post',\n                context: this,\n                data: form,\n                dataType: 'json',\n                success: function (data) {\n                    $('#editProductModal').modal('hide');\n\n                    $('.coupons-and-promos').empty().append(data.cartModel.totals.discountsHtml);\n                    updateCartTotals(data.cartModel);\n                    updateApproachingDiscounts(data.cartModel.approachingDiscounts);\n                    updateAvailability(data.cartModel, uuid);\n                    updateProductDetails(data, uuid);\n\n                    if (data.uuidToBeDeleted) {\n                        $('.uuid-' + data.uuidToBeDeleted).remove();\n                    }\n\n                    validateBasket(data.cartModel);\n\n                    $('body').trigger('cart:update');\n\n                    $.spinner().stop();\n                },\n                error: function (err) {\n                    if (err.responseJSON.redirectUrl) {\n                        window.location.href = err.responseJSON.redirectUrl;\n                    } else {\n                        createErrorNotification(err.responseJSON.errorMessage);\n                        $.spinner().stop();\n                    }\n                }\n            });\n        }\n    });\n\n    base.selectAttribute();\n    base.colorAttribute();\n    base.removeBonusProduct();\n    base.selectBonusProduct();\n    base.enableBonusProductSelection();\n    base.showMoreBonusProducts();\n    base.addBonusProductsToCart();\n    base.focusChooseBonusProductModal();\n    base.trapChooseBonusProductModalFocus();\n    base.onClosingChooseBonusProductModal();\n};\n","'use strict';\n\nmodule.exports = {\n    setTabNextFocus: function (focusParams) {\n        var KEYCODE_TAB = 9;\n        var isTabPressed = (focusParams.event.key === 'Tab' || focusParams.event.keyCode === KEYCODE_TAB);\n\n        if (!isTabPressed) {\n            return;\n        }\n\n        var firstFocusableEl = $(focusParams.containerSelector + ' ' + focusParams.firstElementSelector);\n        var lastFocusableEl = $(focusParams.containerSelector + ' ' + focusParams.lastElementSelector);\n\n        if ($(focusParams.containerSelector + ' ' + focusParams.lastElementSelector).is(':disabled')) {\n            lastFocusableEl = $(focusParams.containerSelector + ' ' + focusParams.nextToLastElementSelector);\n            if ($('.product-quickview.product-set').length > 0) {\n                var linkElements = $(focusParams.containerSelector + ' a#fa-link.share-icons');\n                lastFocusableEl = linkElements[linkElements.length - 1];\n            }\n        }\n\n        if (focusParams.event.shiftKey) /* shift + tab */ {\n            if ($(':focus').is(firstFocusableEl)) {\n                lastFocusableEl.focus();\n                focusParams.event.preventDefault();\n            }\n        } else /* tab */ {\n            if ($(':focus').is(lastFocusableEl)) { // eslint-disable-line\n                firstFocusableEl.focus();\n                focusParams.event.preventDefault();\n            }\n        }\n    }\n};\n","'use strict';\nvar focusHelper = require('../components/focus');\n\n/**\n * Retrieves the relevant pid value\n * @param {jquery} $el - DOM container for a given add to cart button\n * @return {string} - value to be used when adding product to cart\n */\nfunction getPidValue($el) {\n    var pid;\n\n    if ($('#quickViewModal').hasClass('show') && !$('.product-set').length) {\n        pid = $($el).closest('.modal-content').find('.product-quickview').data('pid');\n    } else if ($('.product-set-detail').length || $('.product-set').length) {\n        pid = $($el).closest('.product-detail').find('.product-id').text();\n    } else {\n        pid = $('.product-detail:not(\".bundle-item\")').data('pid');\n    }\n\n    return pid;\n}\n\n/**\n * Retrieve contextual quantity selector\n * @param {jquery} $el - DOM container for the relevant quantity\n * @return {jquery} - quantity selector DOM container\n */\nfunction getQuantitySelector($el) {\n    return $el && $('.set-items').length\n        ? $($el).closest('.product-detail').find('.quantity-select')\n        : $('.quantity-select');\n}\n\n/**\n * Retrieves the value associated with the Quantity pull-down menu\n * @param {jquery} $el - DOM container for the relevant quantity\n * @return {string} - value found in the quantity input\n */\nfunction getQuantitySelected($el) {\n    return getQuantitySelector($el).val();\n}\n\n/**\n * Process the attribute values for an attribute that has image swatches\n *\n * @param {Object} attr - Attribute\n * @param {string} attr.id - Attribute ID\n * @param {Object[]} attr.values - Array of attribute value objects\n * @param {string} attr.values.value - Attribute coded value\n * @param {string} attr.values.url - URL to de/select an attribute value of the product\n * @param {boolean} attr.values.isSelectable - Flag as to whether an attribute value can be\n *     selected.  If there is no variant that corresponds to a specific combination of attribute\n *     values, an attribute may be disabled in the Product Detail Page\n * @param {jQuery} $productContainer - DOM container for a given product\n * @param {Object} msgs - object containing resource messages\n */\nfunction processSwatchValues(attr, $productContainer, msgs) {\n    attr.values.forEach(function (attrValue) {\n        var $attrValue = $productContainer.find('[data-attr=\"' + attr.id + '\"] [data-attr-value=\"' +\n            attrValue.value + '\"]');\n        var $swatchButton = $attrValue.parent();\n\n        if (attrValue.selected) {\n            $attrValue.addClass('selected');\n            $attrValue.siblings('.selected-assistive-text').text(msgs.assistiveSelectedText);\n        } else {\n            $attrValue.removeClass('selected');\n            $attrValue.siblings('.selected-assistive-text').empty();\n        }\n\n        if (attrValue.url) {\n            $swatchButton.attr('data-url', attrValue.url);\n        } else {\n            $swatchButton.removeAttr('data-url');\n        }\n\n        // Disable if not selectable\n        $attrValue.removeClass('selectable unselectable');\n\n        $attrValue.addClass(attrValue.selectable ? 'selectable' : 'unselectable');\n    });\n}\n\n/**\n * Process attribute values associated with an attribute that does not have image swatches\n *\n * @param {Object} attr - Attribute\n * @param {string} attr.id - Attribute ID\n * @param {Object[]} attr.values - Array of attribute value objects\n * @param {string} attr.values.value - Attribute coded value\n * @param {string} attr.values.url - URL to de/select an attribute value of the product\n * @param {boolean} attr.values.isSelectable - Flag as to whether an attribute value can be\n *     selected.  If there is no variant that corresponds to a specific combination of attribute\n *     values, an attribute may be disabled in the Product Detail Page\n * @param {jQuery} $productContainer - DOM container for a given product\n */\nfunction processNonSwatchValues(attr, $productContainer) {\n    var $attr = '[data-attr=\"' + attr.id + '\"]';\n    var $defaultOption = $productContainer.find($attr + ' .select-' + attr.id + ' option:first');\n    $defaultOption.attr('value', attr.resetUrl);\n\n    attr.values.forEach(function (attrValue) {\n        var $attrValue = $productContainer\n            .find($attr + ' [data-attr-value=\"' + attrValue.value + '\"]');\n        $attrValue.attr('value', attrValue.url)\n            .removeAttr('disabled');\n\n        if (!attrValue.selectable) {\n            $attrValue.attr('disabled', true);\n        }\n    });\n}\n\n/**\n * Routes the handling of attribute processing depending on whether the attribute has image\n *     swatches or not\n *\n * @param {Object} attrs - Attribute\n * @param {string} attr.id - Attribute ID\n * @param {jQuery} $productContainer - DOM element for a given product\n * @param {Object} msgs - object containing resource messages\n */\nfunction updateAttrs(attrs, $productContainer, msgs) {\n    // Currently, the only attribute type that has image swatches is Color.\n    var attrsWithSwatches = ['color'];\n\n    attrs.forEach(function (attr) {\n        if (attrsWithSwatches.indexOf(attr.id) > -1) {\n            processSwatchValues(attr, $productContainer, msgs);\n        } else {\n            processNonSwatchValues(attr, $productContainer);\n        }\n    });\n}\n\n/**\n * Updates the availability status in the Product Detail Page\n *\n * @param {Object} response - Ajax response object after an\n *                            attribute value has been [de]selected\n * @param {jQuery} $productContainer - DOM element for a given product\n */\nfunction updateAvailability(response, $productContainer) {\n    var availabilityValue = '';\n    var availabilityMessages = response.product.availability.messages;\n    if (!response.product.readyToOrder) {\n        availabilityValue = '<li><div>' + response.resources.info_selectforstock + '</div></li>';\n    } else {\n        availabilityMessages.forEach(function (message) {\n            availabilityValue += '<li><div>' + message + '</div></li>';\n        });\n    }\n\n    $($productContainer).trigger('product:updateAvailability', {\n        product: response.product,\n        $productContainer: $productContainer,\n        message: availabilityValue,\n        resources: response.resources\n    });\n}\n\n/**\n * Generates html for product attributes section\n *\n * @param {array} attributes - list of attributes\n * @return {string} - Compiled HTML\n */\nfunction getAttributesHtml(attributes) {\n    if (!attributes) {\n        return '';\n    }\n\n    var html = '';\n\n    attributes.forEach(function (attributeGroup) {\n        if (attributeGroup.ID === 'mainAttributes') {\n            attributeGroup.attributes.forEach(function (attribute) {\n                html += '<div class=\"attribute-values\">' + attribute.label + ': '\n                    + attribute.value + '</div>';\n            });\n        }\n    });\n\n    return html;\n}\n\n/**\n * @typedef UpdatedOptionValue\n * @type Object\n * @property {string} id - Option value ID for look up\n * @property {string} url - Updated option value selection URL\n */\n\n/**\n * @typedef OptionSelectionResponse\n * @type Object\n * @property {string} priceHtml - Updated price HTML code\n * @property {Object} options - Updated Options\n * @property {string} options.id - Option ID\n * @property {UpdatedOptionValue[]} options.values - Option values\n */\n\n/**\n * Updates DOM using post-option selection Ajax response\n *\n * @param {OptionSelectionResponse} optionsHtml - Ajax response optionsHtml from selecting a product option\n * @param {jQuery} $productContainer - DOM element for current product\n */\nfunction updateOptions(optionsHtml, $productContainer) {\n\t// Update options\n    $productContainer.find('.product-options').empty().html(optionsHtml);\n}\n\n/**\n * Dynamically creates Bootstrap carousel from response containing images\n * @param {Object[]} imgs - Array of large product images,along with related information\n * @param {jQuery} $productContainer - DOM element for a given product\n */\nfunction createCarousel(imgs, $productContainer) {\n    var carousel = $productContainer.find('.carousel');\n    $(carousel).carousel('dispose');\n    var carouselId = $(carousel).attr('id');\n    $(carousel).empty().append('<ol class=\"carousel-indicators\"></ol><div class=\"carousel-inner\" role=\"listbox\"></div><a class=\"carousel-control-prev\" href=\"#' + carouselId + '\" role=\"button\" data-slide=\"prev\"><span class=\"fa icon-prev\" aria-hidden=\"true\"></span><span class=\"sr-only\">' + $(carousel).data('prev') + '</span></a><a class=\"carousel-control-next\" href=\"#' + carouselId + '\" role=\"button\" data-slide=\"next\"><span class=\"fa icon-next\" aria-hidden=\"true\"></span><span class=\"sr-only\">' + $(carousel).data('next') + '</span></a>');\n    for (var i = 0; i < imgs.length; i++) {\n        $('<div class=\"carousel-item\"><img src=\"' + imgs[i].url + '\" class=\"d-block img-fluid\" alt=\"' + imgs[i].alt + ' image number ' + parseInt(imgs[i].index, 10) + '\" title=\"' + imgs[i].title + '\" itemprop=\"image\" /></div>').appendTo($(carousel).find('.carousel-inner'));\n        $('<li data-target=\"#' + carouselId + '\" data-slide-to=\"' + i + '\" class=\"\"></li>').appendTo($(carousel).find('.carousel-indicators'));\n    }\n    $($(carousel).find('.carousel-item')).first().addClass('active');\n    $($(carousel).find('.carousel-indicators > li')).first().addClass('active');\n    if (imgs.length === 1) {\n        $($(carousel).find('.carousel-indicators, a[class^=\"carousel-control-\"]')).detach();\n    }\n    $(carousel).carousel();\n    $($(carousel).find('.carousel-indicators')).attr('aria-hidden', true);\n}\n\n/**\n * Parses JSON from Ajax call made whenever an attribute value is [de]selected\n * @param {Object} response - response from Ajax call\n * @param {Object} response.product - Product object\n * @param {string} response.product.id - Product ID\n * @param {Object[]} response.product.variationAttributes - Product attributes\n * @param {Object[]} response.product.images - Product images\n * @param {boolean} response.product.hasRequiredAttrsSelected - Flag as to whether all required\n *     attributes have been selected.  Used partially to\n *     determine whether the Add to Cart button can be enabled\n * @param {jQuery} $productContainer - DOM element for a given product.\n */\nfunction handleVariantResponse(response, $productContainer) {\n    var isChoiceOfBonusProducts =\n        $productContainer.parents('.choose-bonus-product-dialog').length > 0;\n    var isVaraint;\n    if (response.product.variationAttributes) {\n        updateAttrs(response.product.variationAttributes, $productContainer, response.resources);\n        isVaraint = response.product.productType === 'variant';\n        if (isChoiceOfBonusProducts && isVaraint) {\n            $productContainer.parent('.bonus-product-item')\n                .data('pid', response.product.id);\n\n            $productContainer.parent('.bonus-product-item')\n                .data('ready-to-order', response.product.readyToOrder);\n        }\n    }\n\n    // Update primary images\n    var primaryImageUrls = response.product.images.large;\n    createCarousel(primaryImageUrls, $productContainer);\n\n    // Update pricing\n    if (!isChoiceOfBonusProducts) {\n        var $priceSelector = $('.prices .price', $productContainer).length\n            ? $('.prices .price', $productContainer)\n            : $('.prices .price');\n        $priceSelector.replaceWith(response.product.price.html);\n    }\n\n    // Update promotions\n    $productContainer.find('.promotions').empty().html(response.product.promotionsHtml);\n\n    updateAvailability(response, $productContainer);\n\n    if (isChoiceOfBonusProducts) {\n        var $selectButton = $productContainer.find('.select-bonus-product');\n        $selectButton.trigger('bonusproduct:updateSelectButton', {\n            product: response.product, $productContainer: $productContainer\n        });\n    } else {\n        // Enable \"Add to Cart\" button if all required attributes have been selected\n        $('button.add-to-cart, button.add-to-cart-global, button.update-cart-product-global').trigger('product:updateAddToCart', {\n            product: response.product, $productContainer: $productContainer\n        }).trigger('product:statusUpdate', response.product);\n    }\n\n    // Update attributes\n    $productContainer.find('.main-attributes').empty()\n        .html(getAttributesHtml(response.product.attributes));\n}\n\n/**\n * @typespec UpdatedQuantity\n * @type Object\n * @property {boolean} selected - Whether the quantity has been selected\n * @property {string} value - The number of products to purchase\n * @property {string} url - Compiled URL that specifies variation attributes, product ID, options,\n *     etc.\n */\n\n/**\n * Updates the quantity DOM elements post Ajax call\n * @param {UpdatedQuantity[]} quantities -\n * @param {jQuery} $productContainer - DOM container for a given product\n */\nfunction updateQuantities(quantities, $productContainer) {\n    if (!($productContainer.parent('.bonus-product-item').length > 0)) {\n        var optionsHtml = quantities.map(function (quantity) {\n            var selected = quantity.selected ? ' selected ' : '';\n            return '<option value=\"' + quantity.value + '\"  data-url=\"' + quantity.url + '\"' +\n                selected + '>' + quantity.value + '</option>';\n        }).join('');\n        getQuantitySelector($productContainer).empty().html(optionsHtml);\n    }\n}\n\n/**\n * updates the product view when a product attribute is selected or deselected or when\n *         changing quantity\n * @param {string} selectedValueUrl - the Url for the selected variation value\n * @param {jQuery} $productContainer - DOM element for current product\n */\nfunction attributeSelect(selectedValueUrl, $productContainer) {\n    if (selectedValueUrl) {\n        $('body').trigger('product:beforeAttributeSelect',\n            { url: selectedValueUrl, container: $productContainer });\n\n        $.ajax({\n            url: selectedValueUrl,\n            method: 'GET',\n            success: function (data) {\n                handleVariantResponse(data, $productContainer);\n                updateOptions(data.product.optionsHtml, $productContainer);\n                updateQuantities(data.product.quantities, $productContainer);\n                $('body').trigger('product:afterAttributeSelect',\n                    { data: data, container: $productContainer });\n                $.spinner().stop();\n            },\n            error: function () {\n                $.spinner().stop();\n            }\n        });\n    }\n}\n\n/**\n * Retrieves url to use when adding a product to the cart\n *\n * @return {string} - The provided URL to use when adding a product to the cart\n */\nfunction getAddToCartUrl() {\n    return $('.add-to-cart-url').val();\n}\n\n/**\n * Parses the html for a modal window\n * @param {string} html - representing the body and footer of the modal window\n *\n * @return {Object} - Object with properties body and footer.\n */\nfunction parseHtml(html) {\n    var $html = $('<div>').append($.parseHTML(html));\n\n    var body = $html.find('.choice-of-bonus-product');\n    var footer = $html.find('.modal-footer').children();\n\n    return { body: body, footer: footer };\n}\n\n/**\n * Retrieves url to use when adding a product to the cart\n *\n * @param {Object} data - data object used to fill in dynamic portions of the html\n */\nfunction chooseBonusProducts(data) {\n    $('.modal-body').spinner().start();\n\n    if ($('#chooseBonusProductModal').length !== 0) {\n        $('#chooseBonusProductModal').remove();\n    }\n    var bonusUrl;\n    if (data.bonusChoiceRuleBased) {\n        bonusUrl = data.showProductsUrlRuleBased;\n    } else {\n        bonusUrl = data.showProductsUrlListBased;\n    }\n\n    var htmlString = '<!-- Modal -->'\n        + '<div class=\"modal fade\" id=\"chooseBonusProductModal\" tabindex=\"-1\" role=\"dialog\">'\n        + '<span class=\"enter-message sr-only\" ></span>'\n        + '<div class=\"modal-dialog choose-bonus-product-dialog\" '\n        + 'data-total-qty=\"' + data.maxBonusItems + '\"'\n        + 'data-UUID=\"' + data.uuid + '\"'\n        + 'data-pliUUID=\"' + data.pliUUID + '\"'\n        + 'data-addToCartUrl=\"' + data.addToCartUrl + '\"'\n        + 'data-pageStart=\"0\"'\n        + 'data-pageSize=\"' + data.pageSize + '\"'\n        + 'data-moreURL=\"' + data.showProductsUrlRuleBased + '\"'\n        + 'data-bonusChoiceRuleBased=\"' + data.bonusChoiceRuleBased + '\">'\n        + '<!-- Modal content-->'\n        + '<div class=\"modal-content\">'\n        + '<div class=\"modal-header\">'\n        + '    <span class=\"\">' + data.labels.selectprods + '</span>'\n        + '    <button type=\"button\" class=\"close pull-right\" data-dismiss=\"modal\">'\n        + '        <span aria-hidden=\"true\">&times;</span>'\n        + '        <span class=\"sr-only\"> </span>'\n        + '    </button>'\n        + '</div>'\n        + '<div class=\"modal-body\"></div>'\n        + '<div class=\"modal-footer\"></div>'\n        + '</div>'\n        + '</div>'\n        + '</div>';\n    $('body').append(htmlString);\n    $('.modal-body').spinner().start();\n\n    $.ajax({\n        url: bonusUrl,\n        method: 'GET',\n        dataType: 'json',\n        success: function (response) {\n            var parsedHtml = parseHtml(response.renderedTemplate);\n            $('#chooseBonusProductModal .modal-body').empty();\n            $('#chooseBonusProductModal .enter-message').text(response.enterDialogMessage);\n            $('#chooseBonusProductModal .modal-header .close .sr-only').text(response.closeButtonText);\n            $('#chooseBonusProductModal .modal-body').html(parsedHtml.body);\n            $('#chooseBonusProductModal .modal-footer').html(parsedHtml.footer);\n            $('#chooseBonusProductModal').modal('show');\n            $.spinner().stop();\n        },\n        error: function () {\n            $.spinner().stop();\n        }\n    });\n}\n\n/**\n * Updates the Mini-Cart quantity value after the customer has pressed the \"Add to Cart\" button\n * @param {string} response - ajax response from clicking the add to cart button\n */\nfunction handlePostCartAdd(response) {\n    $('.minicart').trigger('count:update', response);\n    var messageType = response.error ? 'alert-danger' : 'alert-success';\n    // show add to cart toast\n    if (response.newBonusDiscountLineItem\n        && Object.keys(response.newBonusDiscountLineItem).length !== 0) {\n        chooseBonusProducts(response.newBonusDiscountLineItem);\n    } else {\n        if ($('.add-to-cart-messages').length === 0) {\n            $('body').append(\n                '<div class=\"add-to-cart-messages\"></div>'\n            );\n        }\n\n        $('.add-to-cart-messages').append(\n            '<div class=\"alert ' + messageType + ' add-to-basket-alert text-center\" role=\"alert\">'\n            + response.message\n            + '</div>'\n        );\n\n        setTimeout(function () {\n            $('.add-to-basket-alert').remove();\n        }, 5000);\n    }\n}\n\n/**\n * Retrieves the bundle product item ID's for the Controller to replace bundle master product\n * items with their selected variants\n *\n * @return {string[]} - List of selected bundle product item ID's\n */\nfunction getChildProducts() {\n    var childProducts = [];\n    $('.bundle-item').each(function () {\n        childProducts.push({\n            pid: $(this).find('.product-id').text(),\n            quantity: parseInt($(this).find('label.quantity').data('quantity'), 10)\n        });\n    });\n\n    return childProducts.length ? JSON.stringify(childProducts) : [];\n}\n\n/**\n * Retrieve product options\n *\n * @param {jQuery} $productContainer - DOM element for current product\n * @return {string} - Product options and their selected values\n */\nfunction getOptions($productContainer) {\n    var options = $productContainer\n        .find('.product-option')\n        .map(function () {\n            var $elOption = $(this).find('.options-select');\n            var urlValue = $elOption.val();\n            var selectedValueId = $elOption.find('option[value=\"' + urlValue + '\"]')\n                .data('value-id');\n            return {\n                optionId: $(this).data('option-id'),\n                selectedValueId: selectedValueId\n            };\n        }).toArray();\n\n    return JSON.stringify(options);\n}\n\n/**\n * Makes a call to the server to report the event of adding an item to the cart\n *\n * @param {string | boolean} url - a string representing the end point to hit so that the event can be recorded, or false\n */\nfunction miniCartReportingUrl(url) {\n    if (url) {\n        $.ajax({\n            url: url,\n            method: 'GET',\n            success: function () {\n                // reporting urls hit on the server\n            },\n            error: function () {\n                // no reporting urls hit on the server\n            }\n        });\n    }\n}\n\nmodule.exports = {\n    attributeSelect: attributeSelect,\n    methods: {\n        editBonusProducts: function (data) {\n            chooseBonusProducts(data);\n        }\n    },\n\n    focusChooseBonusProductModal: function () {\n        $('body').on('shown.bs.modal', '#chooseBonusProductModal', function () {\n            $('#chooseBonusProductModal').siblings().attr('aria-hidden', 'true');\n            $('#chooseBonusProductModal .close').focus();\n        });\n    },\n\n    onClosingChooseBonusProductModal: function () {\n        $('body').on('hidden.bs.modal', '#chooseBonusProductModal', function () {\n            $('#chooseBonusProductModal').siblings().attr('aria-hidden', 'false');\n        });\n    },\n\n    trapChooseBonusProductModalFocus: function () {\n        $('body').on('keydown', '#chooseBonusProductModal', function (e) {\n            var focusParams = {\n                event: e,\n                containerSelector: '#chooseBonusProductModal',\n                firstElementSelector: '.close',\n                lastElementSelector: '.add-bonus-products'\n            };\n            focusHelper.setTabNextFocus(focusParams);\n        });\n    },\n\n    colorAttribute: function () {\n        $(document).on('click', '[data-attr=\"color\"] button', function (e) {\n            e.preventDefault();\n\n            if ($(this).attr('disabled')) {\n                return;\n            }\n            var $productContainer = $(this).closest('.set-item');\n            if (!$productContainer.length) {\n                $productContainer = $(this).closest('.product-detail');\n            }\n\n            attributeSelect($(this).attr('data-url'), $productContainer);\n        });\n    },\n\n    selectAttribute: function () {\n        $(document).on('change', 'select[class*=\"select-\"], .options-select', function (e) {\n            e.preventDefault();\n\n            var $productContainer = $(this).closest('.set-item');\n            if (!$productContainer.length) {\n                $productContainer = $(this).closest('.product-detail');\n            }\n            attributeSelect(e.currentTarget.value, $productContainer);\n        });\n    },\n\n    availability: function () {\n        $(document).on('change', '.quantity-select', function (e) {\n            e.preventDefault();\n\n            var $productContainer = $(this).closest('.product-detail');\n            if (!$productContainer.length) {\n                $productContainer = $(this).closest('.modal-content').find('.product-quickview');\n            }\n\n            if ($('.bundle-items', $productContainer).length === 0) {\n                attributeSelect($(e.currentTarget).find('option:selected').data('url'),\n                    $productContainer);\n            }\n        });\n    },\n\n    addToCart: function () {\n        $(document).on('click', 'button.add-to-cart, button.add-to-cart-global', function () {\n            var addToCartUrl;\n            var pid;\n            var pidsObj;\n            var setPids;\n\n            $('body').trigger('product:beforeAddToCart', this);\n\n            if ($('.set-items').length && $(this).hasClass('add-to-cart-global')) {\n                setPids = [];\n\n                $('.product-detail').each(function () {\n                    if (!$(this).hasClass('product-set-detail')) {\n                        setPids.push({\n                            pid: $(this).find('.product-id').text(),\n                            qty: $(this).find('.quantity-select').val(),\n                            options: getOptions($(this))\n                        });\n                    }\n                });\n                pidsObj = JSON.stringify(setPids);\n            }\n\n            pid = getPidValue($(this));\n\n            var $productContainer = $(this).closest('.product-detail');\n            if (!$productContainer.length) {\n                $productContainer = $(this).closest('.quick-view-dialog').find('.product-detail');\n            }\n\n            addToCartUrl = getAddToCartUrl();\n\n            var form = {\n                pid: pid,\n                pidsObj: pidsObj,\n                childProducts: getChildProducts(),\n                quantity: getQuantitySelected($(this))\n            };\n\n            if (!$('.bundle-item').length) {\n                form.options = getOptions($productContainer);\n            }\n\n            $(this).trigger('updateAddToCartFormData', form);\n            if (addToCartUrl) {\n                $.ajax({\n                    url: addToCartUrl,\n                    method: 'POST',\n                    data: form,\n                    success: function (data) {\n                        handlePostCartAdd(data);\n                        $('body').trigger('product:afterAddToCart', data);\n                        $.spinner().stop();\n                        miniCartReportingUrl(data.reportingURL);\n                    },\n                    error: function () {\n                        $.spinner().stop();\n                    }\n                });\n            }\n        });\n    },\n    selectBonusProduct: function () {\n        $(document).on('click', '.select-bonus-product', function () {\n            var $choiceOfBonusProduct = $(this).parents('.choice-of-bonus-product');\n            var pid = $(this).data('pid');\n            var maxPids = $('.choose-bonus-product-dialog').data('total-qty');\n            var submittedQty = parseInt($choiceOfBonusProduct.find('.bonus-quantity-select').val(), 10);\n            var totalQty = 0;\n            $.each($('#chooseBonusProductModal .selected-bonus-products .selected-pid'), function () {\n                totalQty += $(this).data('qty');\n            });\n            totalQty += submittedQty;\n            var optionID = $choiceOfBonusProduct.find('.product-option').data('option-id');\n            var valueId = $choiceOfBonusProduct.find('.options-select option:selected').data('valueId');\n            if (totalQty <= maxPids) {\n                var selectedBonusProductHtml = ''\n                + '<div class=\"selected-pid row\" '\n                + 'data-pid=\"' + pid + '\"'\n                + 'data-qty=\"' + submittedQty + '\"'\n                + 'data-optionID=\"' + (optionID || '') + '\"'\n                + 'data-option-selected-value=\"' + (valueId || '') + '\"'\n                + '>'\n                + '<div class=\"col-sm-11 col-9 bonus-product-name\" >'\n                + $choiceOfBonusProduct.find('.product-name').html()\n                + '</div>'\n                + '<div class=\"col-1\"><i class=\"fa fa-times\" aria-hidden=\"true\"></i></div>'\n                + '</div>'\n                ;\n                $('#chooseBonusProductModal .selected-bonus-products').append(selectedBonusProductHtml);\n                $('.pre-cart-products').html(totalQty);\n                $('.selected-bonus-products .bonus-summary').removeClass('alert-danger');\n            } else {\n                $('.selected-bonus-products .bonus-summary').addClass('alert-danger');\n            }\n        });\n    },\n    removeBonusProduct: function () {\n        $(document).on('click', '.selected-pid', function () {\n            $(this).remove();\n            var $selected = $('#chooseBonusProductModal .selected-bonus-products .selected-pid');\n            var count = 0;\n            if ($selected.length) {\n                $selected.each(function () {\n                    count += parseInt($(this).data('qty'), 10);\n                });\n            }\n\n            $('.pre-cart-products').html(count);\n            $('.selected-bonus-products .bonus-summary').removeClass('alert-danger');\n        });\n    },\n    enableBonusProductSelection: function () {\n        $('body').on('bonusproduct:updateSelectButton', function (e, response) {\n            $('button.select-bonus-product', response.$productContainer).attr('disabled',\n                (!response.product.readyToOrder || !response.product.available));\n            var pid = response.product.id;\n            $('button.select-bonus-product', response.$productContainer).data('pid', pid);\n        });\n    },\n    showMoreBonusProducts: function () {\n        $(document).on('click', '.show-more-bonus-products', function () {\n            var url = $(this).data('url');\n            $('.modal-content').spinner().start();\n            $.ajax({\n                url: url,\n                method: 'GET',\n                success: function (html) {\n                    var parsedHtml = parseHtml(html);\n                    $('.modal-body').append(parsedHtml.body);\n                    $('.show-more-bonus-products:first').remove();\n                    $('.modal-content').spinner().stop();\n                },\n                error: function () {\n                    $('.modal-content').spinner().stop();\n                }\n            });\n        });\n    },\n    addBonusProductsToCart: function () {\n        $(document).on('click', '.add-bonus-products', function () {\n            var $readyToOrderBonusProducts = $('.choose-bonus-product-dialog .selected-pid');\n            var queryString = '?pids=';\n            var url = $('.choose-bonus-product-dialog').data('addtocarturl');\n            var pidsObject = {\n                bonusProducts: []\n            };\n\n            $.each($readyToOrderBonusProducts, function () {\n                var qtyOption =\n                    parseInt($(this)\n                        .data('qty'), 10);\n\n                var option = null;\n                if (qtyOption > 0) {\n                    if ($(this).data('optionid') && $(this).data('option-selected-value')) {\n                        option = {};\n                        option.optionId = $(this).data('optionid');\n                        option.productId = $(this).data('pid');\n                        option.selectedValueId = $(this).data('option-selected-value');\n                    }\n                    pidsObject.bonusProducts.push({\n                        pid: $(this).data('pid'),\n                        qty: qtyOption,\n                        options: [option]\n                    });\n                    pidsObject.totalQty = parseInt($('.pre-cart-products').html(), 10);\n                }\n            });\n            queryString += JSON.stringify(pidsObject);\n            queryString = queryString + '&uuid=' + $('.choose-bonus-product-dialog').data('uuid');\n            queryString = queryString + '&pliuuid=' + $('.choose-bonus-product-dialog').data('pliuuid');\n            $.spinner().start();\n            $.ajax({\n                url: url + queryString,\n                method: 'POST',\n                success: function (data) {\n                    $.spinner().stop();\n                    if (data.error) {\n                        $('#chooseBonusProductModal').modal('hide');\n                        if ($('.add-to-cart-messages').length === 0) {\n                            $('body').append('<div class=\"add-to-cart-messages\"></div>');\n                        }\n                        $('.add-to-cart-messages').append(\n                            '<div class=\"alert alert-danger add-to-basket-alert text-center\"'\n                            + ' role=\"alert\">'\n                            + data.errorMessage + '</div>'\n                        );\n                        setTimeout(function () {\n                            $('.add-to-basket-alert').remove();\n                        }, 3000);\n                    } else {\n                        $('.configure-bonus-product-attributes').html(data);\n                        $('.bonus-products-step2').removeClass('hidden-xl-down');\n                        $('#chooseBonusProductModal').modal('hide');\n\n                        if ($('.add-to-cart-messages').length === 0) {\n                            $('body').append('<div class=\"add-to-cart-messages\"></div>');\n                        }\n                        $('.minicart-quantity').html(data.totalQty);\n                        $('.add-to-cart-messages').append(\n                            '<div class=\"alert alert-success add-to-basket-alert text-center\"'\n                            + ' role=\"alert\">'\n                            + data.msgSuccess + '</div>'\n                        );\n                        setTimeout(function () {\n                            $('.add-to-basket-alert').remove();\n                            if ($('.cart-page').length) {\n                                location.reload();\n                            }\n                        }, 1500);\n                    }\n                },\n                error: function () {\n                    $.spinner().stop();\n                }\n            });\n        });\n    },\n\n    getPidValue: getPidValue,\n    getQuantitySelected: getQuantitySelected,\n    miniCartReportingUrl: miniCartReportingUrl\n};\n","'use strict';\n\nmodule.exports = function (include) {\n    if (typeof include === 'function') {\n        include();\n    } else if (typeof include === 'object') {\n        Object.keys(include).forEach(function (key) {\n            if (typeof include[key] === 'function') {\n                include[key]();\n            }\n        });\n    }\n};\n"],"sourceRoot":""}